{"version":3,"file":"main.5d18f0929d820a6fc222.hot-update.js","sources":["webpack:///./src/server/index.js"],"sourcesContent":["import express from 'express'\nimport React from 'react'\nimport { renderToString } from 'react-dom/server'\nimport { Provider } from 'react-redux'\nimport { StaticRouter } from 'react-router-dom'\nimport serialize from 'serialize-javascript'\n\nimport App from '../common/main/App'\nimport configureStore from '../common/main/configureStore'\nimport reducers from '../common/main/reducers'\nimport config from '../config'\n\nconst assets = require(process.env.RAZZLE_ASSETS_MANIFEST)\nvar cors = require('cors');\n\nconst server = express()\n\nserver\n  .disable('x-powered-by')\n  .use(cors())\n  //.use(express.static(process.env.RAZZLE_PUBLIC_DIR))\n  .get('/*', (req, res) => {\n    // Compile an initial state\n    const preloadedState = reducers({}, { type: 'INITIALIZE' })\n\n    // Create a new Redux store instance\n    const store = configureStore(preloadedState)\n\n    // Render the component to a string\n    const markup = renderToString(\n      <Provider store={store}>\n        <StaticRouter location={req.url} context={{}}>\n          <App />\n        </StaticRouter>\n      </Provider>\n    )\n\n    // Grab the initial state from our Redux store\n    const finalState = store.getState()\n\n    res.send(`<!doctype html>\n    <html lang=\"\">\n    <head>\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n        <meta charSet='utf-8' />\n        <title>${config.title}</title>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        ${\n          assets.client.css\n            ? `<link rel=\"stylesheet\" href=\"${assets.client.css}\">`\n            : ''\n        }\n          ${\n            process.env.NODE_ENV === 'production'\n              ? `<script src=\"${assets.client.js}\" defer></script>`\n              : `<script src=\"${assets.client.js}\" defer crossorigin></script>`\n          }\n    </head>\n    <body>\n        <div id=\"root\">${markup}</div>\n        <script>\n          window.__PRELOADED_STATE__ = ${serialize(finalState)}\n        </script>\n    </body>\n</html>`)\n  })\n\nexport default server\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AAAA;AAKA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAKA;AAEA;AAyBA;AAEA;;;;A","sourceRoot":""}